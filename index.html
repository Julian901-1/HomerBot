<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>HomerBot — Инвестиционный Кошелёк</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<!-- Boot screen -->
<div id="boot-screen" role="status" aria-live="polite">
<div id="boot-center">
 <div id="boot-title">HomerBot</div>
 <div id="boot-progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
   <div id="boot-progress-fill"></div>
 </div>
 <div id="boot-hint">Готовим платформу…</div>
</div>
</div>

 <main class="app-container">
     <header class="header">
       <div class="header-content">
         <div id="appBrand" style="opacity:0">HomerBot</div>
         <button class="profile-btn" onclick="openModal('profile')" aria-label="Открыть профиль">
           <svg class="nav-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
         </button>
       </div>
     </header>
     <div id="status" class="status" role="status" aria-live="polite"></div>

     <section id="pageContainer">
            <div class="page active" id="pageHome">
                <div class="card">
                    <div class="balance-section">
                        <div class="balance-label-container">
                            <div class="balance-label">Общий баланс</div>
                            <div class="balance-currency" onclick="toggleCurrencyDropdown(event)">
                                <span id="currentCurrency">RUB</span><span class="currency-arrow">▼</span>
                                <div class="currency-dropdown" id="currencyDropdown">
                                    <div class="currency-option active" onclick="selectCurrency('RUB', event)">RUB</div>
                                    <div class="currency-option" onclick="selectCurrency('USD', event)">USD</div>
                                    <div class="currency-option" onclick="selectCurrency('EUR', event)">EUR</div>
                                </div>
                            </div>
                        </div>
                        <div class="balance-main" id="balanceValue">—</div>
                        <div class="balance-stats">
                            <div class="balance-stat">
                              <div class="stat-label">Свободно</div>
                              <div class="stat-value" id="freeBalance">—</div>
                            </div>
                            <div class="balance-stat">
                              <div class="stat-label">Инвестировано</div>
                              <div class="stat-value stat-positive" id="investedBalance">—</div>
                            </div>
                            <div class="balance-stat">
                              <div class="stat-label">Доход сегодня</div>
                              <div class="stat-value stat-positive" id="todayIncome">—</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="btn-group">
                   <button class="btn btn-primary" onclick="openModal('deposit')">Депозит</button>
                   <button class="btn" onclick="openModal('withdraw')">Вывод</button>
                </div>

                <div class="strategies-section">
                    <h2>Инвестиционные возможности</h2>
                    <div class="strategy-layout">
                      <div class="left-strategies">
                        <div class="strategy-option" onclick="openModal('strategy16')">
                          <div class="rate-badge">16%</div>
                        </div>
                        <div class="strategy-option" onclick="openModal('strategy17')">
                          <div class="rate-badge">17%</div>
                        </div>
                        <div class="strategy-option" onclick="openModal('strategy18')">
                          <div class="rate-badge">18%</div>
                        </div>
                      </div>
                      <div class="right-options">
                        <div class="option-rectangle">
                          <span>Вечерний процент</span>
                        </div>
                        <div class="option-rectangle">
                          <span>Кэшбэк AUTO</span>
                        </div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="page" id="pagePortfolio">
              <div class="card">
                <h2 style="margin-bottom: 16px;">Мой портфель</h2>
                <div id="portfolio-list"></div>
                <p id="portfolio-placeholder" style="text-align: center; padding: 40px 0;">Нет активных инвестиций.</p>
              </div>
            </div>

            <div class="page" id="pageHistory">
              <div class="card">
                <h2 style="margin-bottom: 16px;">История операций</h2>
                <div class="filter-chips">
                  <div class="filter-chip active" onclick="applyHistoryFilter(this, 'all')">Все</div>
                  <div class="filter-chip" onclick="applyHistoryFilter(this, 'deposit')">Депозиты</div>
                  <div class="filter-chip" onclick="applyHistoryFilter(this, 'withdraw')">Выводы</div>
                  <div class="filter-chip" onclick="applyHistoryFilter(this, 'invest')">Инвестиции</div>
                </div>
                <div id="history-list"></div>
                <button class="btn" id="load-more-history" style="width:100%; margin-top:16px; display:none;">Загрузить ещё</button>
                <p id="history-placeholder" style="text-align: center; padding: 40px 0;">История операций пуста.</p>
              </div>
            </div>
        </section>

        <nav class="bottom-nav" role="navigation" aria-label="Основная навигация">
          <div class="nav-items">
            <div class="nav-item active" onclick="openPage('Home')" role="button" tabindex="0" aria-label="Главная страница">
              <svg class="nav-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9,22 9,12 15,12 15,22"/></svg>
              <span class="nav-label">Главная</span>
            </div>
            <div class="nav-item" onclick="openPage('Portfolio')" role="button" tabindex="0" aria-label="Портфель инвестиций">
              <svg class="nav-icon" viewBox="0 0 24 24" aria-hidden="true"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
              <span class="nav-label">Портфель</span>
            </div>
            <div class="nav-item" onclick="openPage('History')" role="button" tabindex="0" aria-label="История операций">
              <svg class="nav-icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/></svg>
              <span class="nav-label">История</span>
            </div>
          </div>
        </div>
        </nav>
    </main>

    <!-- Profile -->
    <div id="modalProfile" class="modal-overlay" role="dialog" aria-labelledby="profile-title" aria-modal="true">
      <div class="modal">
        <div class="modal-header"><h2 id="profile-title" class="modal-title">Профиль</h2><button class="close-btn" onclick="closeModal('profile')" aria-label="Закрыть профиль">✕</button></div>
        <div class="card" style="text-align: center; margin: 0;">
          <h3 id="profileUsername">—</h3>
          <p style="color: var(--text-secondary); font-size: 14px;">Telegram пользователь</p>
        </div>
        <div style="margin-top: 16px;">
          <div class="method-card disabled"><div class="method-info"><h3>Безопасность <span class="dev-notice">В разработке</span></h3><p>KYC, Пин-код, Подтверждение вывода</p></div></div>
          <div class="method-card disabled"><div class="method-info"><h3>Язык <span class="dev-notice">В разработке</span></h3><p>Русский, English</p></div></div>
          <div class="method-card" onclick="window.open('https://docs.google.com/document/d/1Rv3N2iTgwHXhTkSgv-BwKLrekVpZtoGfU_ct2lDw00g/edit?usp=sharing', '_blank')"><div class="method-info"><h3>Юридическая информация</h3><p>Условия использования</p></div></div>
        </div>
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; margin-top:16px; background:var(--glass-bg); border:1px solid var(--glass-border); border-radius:12px;">
          <label for="devModeToggle">Режим разработчика</label>
          <label class="toggle-switch"><input type="checkbox" id="devModeToggle"><span class="slider"></span></label>
        </div>
        <div id="devVersion" class="dev-version" style="display:none; text-align:center; font-size:12px; opacity:.7; margin-top:6px; margin-bottom:12px;">
 v1
</div>
      </div>
    </div>

<!-- Deposit -->
<div id="modalDeposit" class="modal-overlay" role="dialog" aria-labelledby="deposit-title" aria-modal="true">
  <div class="modal">
    <div class="modal-header">
      <div>
        <h2 id="deposit-title" class="modal-title">Депозит</h2>
        <div style="font-size:12px;color:var(--text-secondary);margin-top:4px;">Выберите сумму депозита (100 - 10 млн. ₽)</div>
      </div>
      <button class="close-btn" onclick="closeModal('deposit')" aria-label="Закрыть депозит">✕</button>
    </div>

    <!-- Шаг 1: ввод суммы + согласие -->
    <div id="deposit-step1">
      <input type="text" id="depositAmount" class="amount-input" placeholder="0" oninput="formatAmountInput(this); updateDepositBtnState();" inputmode="decimal">
      <div class="quick-amounts">
        <button class="quick-amount-btn" onclick="setDepositAmount(1000)">1 000</button>
        <button class="quick-amount-btn" onclick="setDepositAmount(5000)">5 000</button>
        <button class="quick-amount-btn" onclick="setDepositAmount(10000)">10 000</button>
        <button class="quick-amount-btn" onclick="setDepositAmount(25000)">25 000</button>
        <button class="quick-amount-btn" onclick="setDepositAmount(50000)">50 000</button>
        <button class="quick-amount-btn" onclick="setDepositAmount(100000)">100 000</button>
      </div>

      <!-- Тумблер согласия по центру -->
      <div class="agree-row">
        <span>Согласен с&nbsp;<a href="https://docs.google.com/document/d/1Rv3N2iTgwHXhTkSgv-BwKLrekVpZtoGfU_ct2lDw00g/edit?usp=sharing" target="_blank">условиями</a></span>
        <label class="toggle-switch">
          <input type="checkbox" id="depositAgree">
          <span class="slider"></span>
        </label>
      </div>
<button class="btn btn-primary" id="depositConfirmBtn" style="width:100%" disabled>
  Пополнить счёт по СБП
</button>
    </div>

    <!-- Шаг 2: инструкции + номер и копирование + отмена -->
<div id="deposit-step2" style="display:none;">
  <div class="spinner-big" aria-label="Загрузка"></div>

  <div class="glass-card" style="margin-top:16px;">
    <!-- Сумма -->
    <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
      <input type="text" id="deposit-amount-display" class="input-field" value="—" readonly
             style="text-align:center;font-size:18px;font-weight:700;">
      <button class="copy-btn" onclick="const val = document.getElementById('deposit-amount-display').value; const clean = val.replace(/\s/g, '').replace(',', '.').replace(/[^\d.]/g, ''); copyToClipboard(clean, this)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
      </button>
    </div>

    <!-- Код операции -->
    <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
      <input type="text" id="deposit-short-display" class="input-field" value="—" readonly
             style="text-align:center;font-size:18px;font-weight:700;">
      <button class="copy-btn" onclick="copyToClipboard((document.getElementById('deposit-short-display').value||'').replace('#',''), this)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
      </button>
    </div>

    <div style="font-size:13px;color:var(--text-secondary);text-align:center;margin-bottom:10px;">
      <b>ОБЯЗАТЕЛЬНО</b> укажите в комментарии к переводу данный код, чтобы начисление средств произошло автоматически.
    </div>

    <!-- Телефон -->
    <div style="display:flex; gap:8px; align-items:center; margin-top:4px;">
      <input type="text" class="input-field" value="+7 (916) 643-54-94" readonly
             style="text-align:center;font-size:18px;font-weight:700;">
      <button class="copy-btn" onclick="copyToClipboard('+79166435494', this)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
      </button>
    </div>

    <div style="font-size:13px;color:var(--text-secondary);margin-top:12px;">
      Переведите средства по СБП (Т-Банк) по данному номеру для зачисления средств на счёт.
      После зачисления средств баланс обновится в течение суток.
    </div>
  </div>
</div>
    </div> <!-- / .modal -->
</div> <!-- / #modalDeposit -->

    <!-- Withdraw -->
    <div id="modalWithdraw" class="modal-overlay" role="dialog" aria-labelledby="withdraw-title" aria-modal="true">
      <div class="modal">
        <div class="modal-header"><h2 id="withdraw-title" class="modal-title">Вывод средств</h2><button class="close-btn" onclick="closeModal('withdraw')" aria-label="Закрыть вывод">✕</button></div>

        <div id="withdraw-method-choice" style="display:none;">
<div class="method-card" onclick="selectWithdrawMethod('sbp')">
  <div class="method-info"><h3>Перевод по СБП</h3></div>
</div>
          <div class="method-card disabled"><div class="method-info"><h3>Криптовалюта <span class="dev-notice">В разработке</span></h3></div></div>
          <div class="method-card disabled"><div class="method-info"><h3>Банковские реквизиты <span class="dev-notice">В разработке</span></h3></div></div>
        </div>

        <div id="withdraw-view" style="display:none;">
          <p style="text-align: center; color: var(--text-secondary);">Доступно для вывода: <b id="withdrawAvailable">0.00 ₽</b></p>
          <div id="withdraw-recipient-select" class="custom-select">
            <div class="select-trigger" id="select-trigger">Выберите реквизиты</div>
            <div class="select-options" id="select-options"></div>
          </div>
          <input type="text" class="amount-input" id="withdrawAmount" placeholder="0" oninput="formatAmountInput(this); updateWithdrawBtnState();" inputmode="decimal">
          <button class="btn btn-primary" id="withdrawConfirmBtn" style="width:100%">Создать запрос</button>
        </div>

        <div id="withdraw-add-sbp-form" style="display:none;">
          <input type="text" class="input-field" id="withdraw-sbp-phone" style="text-align:center; margin-bottom: 16px;" placeholder="Номер телефона для СБП">
          <p style="text-align:center; color: var(--text-secondary); font-size: 14px;">Выберите банк получателя</p>
<div class="bank-icons">
  <div class="bank-icon" data-bank="Alfa">
    <img src="./assets/alphabank.jpg" alt="Альфа" onerror="this.replaceWith(Object.assign(document.createElement('span'),{textContent:'Альфа'}))">
  </div>
  <div class="bank-icon" data-bank="Sberbank">
    <img src="./assets/sberbank.jpg" alt="Сбербанк" onerror="this.replaceWith(Object.assign(document.createElement('span'),{textContent:'Сбербанк'}))">
  </div>
  <div class="bank-icon" data-bank="TBank">
    <img src="./assets/tbank.jpg" alt="Т-Банк" onerror="this.replaceWith(Object.assign(document.createElement('span'),{textContent:'Т-Банк'}))">
  </div>
</div>
          <button class="btn btn-primary" id="save-sbp-btn" style="width:100%; margin-top: 16px;">Сохранить и продолжить</button>
        </div>
      </div>
    </div>
    
    <!-- Strategies -->
<div id="modalStrategy16" class="modal-overlay" role="dialog" aria-labelledby="strategy16-title" aria-modal="true">
  <div class="modal">
    <div class="modal-header">
      <h2 id="strategy16-title" class="modal-title">Ликвидный</h2>
      <button class="close-btn" onclick="closeModal('strategy16')" aria-label="Закрыть стратегию">✕</button>
    </div>
    <div class="glass-card" style="margin-bottom:12px;">
      <p style="color:var(--text-secondary);font-size:14px;">
        • Начисление процентов <span style="color: #4ade80;">ежедневно</span>, вывод без штрафов.<br>
        • Доходность фиксируется на момент пополнения.<br>
        • Подходит для «подушки безопасности» — можно <span style="color: #4ade80;">пополнить</span>/<span style="color: #dc2626;">вывести</span> в любой день.
      </p>
      <div class="composition-section">
        <h4>Состав:</h4>
        <div class="option-tools">
          <div class="tool-item">
            <span class="tool-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="5" width="18" height="14" rx="2"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
                <line x1="7" y1="15" x2="7" y2="15"/>
                <line x1="11" y1="15" x2="11" y2="15"/>
              </svg>
            </span>
            <span class="tool-label">Банковские вклады</span>
          </div>
        </div>
      </div>
    </div>
    <button class="btn btn-primary" onclick="openNewInvestment('16')" style="width:100%;">Инвестировать</button>
  </div>
</div>
    <div id="modalStrategy17" class="modal-overlay" role="dialog" aria-labelledby="strategy17-title" aria-modal="true">
  <div class="modal">
    <div class="modal-header">
      <h2 id="strategy17-title" class="modal-title">Стабильный</h2>
      <button class="close-btn" onclick="closeModal('strategy17')" aria-label="Закрыть стратегию">✕</button>
    </div>
    <div class="glass-card" style="margin-bottom:12px;">
      <p style="color:var(--text-secondary);font-size:14px;">
        • <span style="color: #3b82f6;">Заморозка</span> на 30 дней, частичный досрочный <span style="color: #dc2626;">вывод</span> с потерей накопленного дохода.<br>
        • Баланс между доходностью и доступностью средств.
      </p>
      <div class="composition-section">
        <h4>Состав:</h4>
        <div class="option-tools">
          <div class="tool-item">
            <span class="tool-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="5" width="18" height="14" rx="2"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
                <line x1="7" y1="15" x2="7" y2="15"/>
                <line x1="11" y1="15" x2="11" y2="15"/>
              </svg>
            </span>
            <span class="tool-label">Банковские вклады</span>
          </div>
          <div class="tool-item">
            <span class="tool-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="20" x2="18" y2="10"/>
                <line x1="12" y1="20" x2="12" y2="4"/>
                <line x1="6" y1="20" x2="6" y2="14"/>
              </svg>
            </span>
            <span class="tool-label">ЦФА умеренного риска</span>
          </div>
        </div>
      </div>
    </div>
    <button class="btn btn-primary" onclick="openNewInvestment('17')" style="width:100%;">Инвестировать</button>
  </div>
</div>
   <div id="modalStrategy18" class="modal-overlay" role="dialog" aria-labelledby="strategy18-title" aria-modal="true">
  <div class="modal">
     <div class="modal-header">
       <h2 id="strategy18-title" class="modal-title">Агрессивный</h2>
       <button class="close-btn" onclick="closeModal('strategy18')" aria-label="Закрыть стратегию">✕</button>
     </div>
    <div class="glass-card" style="margin-bottom:12px;">
      <p style="color:var(--text-secondary);font-size:14px;">
        • <span style="color: #3b82f6;">Заморозка</span> на 90 дней, досрочный <span style="color: #dc2626;">вывод</span> — с потерей процентов.<br>
        • Для тех, кто хочет максимальную ставку и готов к ожиданию.
      </p>
      <div class="composition-section">
        <h4>Состав:</h4>
        <div class="option-tools">
          <div class="tool-item">
            <span class="tool-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="5" width="18" height="14" rx="2"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
                <line x1="7" y1="15" x2="7" y2="15"/>
                <line x1="11" y1="15" x2="11" y2="15"/>
              </svg>
            </span>
            <span class="tool-label">Вклады</span>
          </div>
          <div class="tool-item">
            <span class="tool-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="20" x2="18" y2="10"/>
                <line x1="12" y1="20" x2="12" y2="4"/>
                <line x1="6" y1="20" x2="6" y2="14"/>
              </svg>
            </span>
            <span class="tool-label">ЦФА</span>
          </div>
          <div class="tool-item">
            <span class="tool-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="1" x2="12" y2="23"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
              </svg>
            </span>
            <span class="tool-label">Краткосрочные займы</span>
          </div>
        </div>
      </div>
    </div>
    <button class="btn btn-primary" onclick="openNewInvestment('18')" style="width:100%;">Инвестировать</button>
  </div>
</div>
    <!-- New Investment -->
    <div id="modalNewInvestment" class="modal-overlay" role="dialog" aria-labelledby="new-investment-title" aria-modal="true">
      <div class="modal">
        <div class="modal-header">
          <h2 id="new-investment-title" class="modal-title">Новая инвестиция</h2>
          <button class="close-btn" onclick="closeModal('newInvestment')" aria-label="Закрыть новую инвестицию">✕</button>
        </div>
        <div class="input-field" id="niStrategyReadonly" style="text-align:center;font-weight:700;margin-bottom:12px;">—</div>
        <p style="text-align: center; color: var(--text-secondary); margin-bottom: 12px;">Доступно для инвестирования: <b id="investAvailable">—</b></p>
        <input type="text" class="amount-input" id="niAmount" placeholder="0" oninput="formatAmountInput(this); updateInvestButtonState();" inputmode="decimal">
        <button class="btn btn-primary" style="width:100%" id="niConfirmBtn" disabled>Подтвердить</button>
      </div>
    </div>
    <script src="app.js"></script>
  </body>
</html>
